//Generated by TurboLink CodeGenerator, do not edit!
#include "SSro/BusClient.h"
#include "SSro/BusService.h"
#include "BusContext.h"
#include "TurboLinkGrpcManager_Private.h"
#include "Templates/SharedPointer.h"

FGrpcContextHandle UBusServiceClient::InitResetReaderBus()
{
	FGrpcContextHandle handle = Service->TurboLinkManager->GetNextContextHandle();
	auto context = UGrpcClient::MakeContext<GrpcContext_BusService_ResetReaderBus>(handle);
	context->RpcContext = UTurboLinkGrpcManager::Private::CreateRpcClientContext();
	return context->GetHandle();
}

void UBusServiceClient::ResetReaderBus(FGrpcContextHandle Handle, const FGrpcSroBusTarget& Request, TMap<FString, FString>& MetaData)
{
	auto context = UGrpcClient::GetContext(Handle);
	if (context != nullptr)
	{
		for (auto const& Pair : MetaData)
		{
			context->Get()->RpcContext->AddMetadata(TCHAR_TO_UTF8(*Pair.Key), TCHAR_TO_UTF8(*Pair.Value));
		}
		auto contextResetReaderBus = StaticCastSharedPtr<GrpcContext_BusService_ResetReaderBus>(*context);
		contextResetReaderBus->Call(Request);
	}
}

FGrpcContextHandle UBusServiceClient::InitResetWriterBus()
{
	FGrpcContextHandle handle = Service->TurboLinkManager->GetNextContextHandle();
	auto context = UGrpcClient::MakeContext<GrpcContext_BusService_ResetWriterBus>(handle);
	context->RpcContext = UTurboLinkGrpcManager::Private::CreateRpcClientContext();
	return context->GetHandle();
}

void UBusServiceClient::ResetWriterBus(FGrpcContextHandle Handle, const FGrpcSroBusTarget& Request, TMap<FString, FString>& MetaData)
{
	auto context = UGrpcClient::GetContext(Handle);
	if (context != nullptr)
	{
		for (auto const& Pair : MetaData)
		{
			context->Get()->RpcContext->AddMetadata(TCHAR_TO_UTF8(*Pair.Key), TCHAR_TO_UTF8(*Pair.Value));
		}
		auto contextResetWriterBus = StaticCastSharedPtr<GrpcContext_BusService_ResetWriterBus>(*context);
		contextResetWriterBus->Call(Request);
	}
}

void UBusServiceClient::TryCancel(FGrpcContextHandle Handle)
{
	auto context = UGrpcClient::GetContext(Handle);
	if (context != nullptr)
	{
		(*context)->TryCancel();
	}
}

void UBusServiceClient::Shutdown()
{
	OnResetReaderBusResponse.Clear();
	OnResetWriterBusResponse.Clear();
	Super::Shutdown();
}

